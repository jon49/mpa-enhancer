(()=>{let l=document,i=window,o=l.querySelector.bind(l);function c(t,e){return t?.hasAttribute(e)}function d(t,e){return t?.getAttribute(e)}function f(){let t=d(l.body,"mpa-page-name");return t||new URL(l.location.href).pathname.replace(/\/$/,"")}let m=null;i.addEventListener("click",t=>{m=t.target});function s(t){return t?.getBoundingClientRect().top}i.addEventListener("unload",()=>{let t=g()||{},e=new Set(t.__||[]),n=f();c(l.body,"mpa-persist")&&(e.add(n),t.__=Array.from(e));for(let u in Object.keys(t))e.has(u)||u==="__"||delete t[u];let r=l.activeElement,a=r===l.body?m:r,y=d(a?.closest("[mpa-miss]"),"mpa-miss"),q=a?.getAttribute("name");t[n]={y:i.scrollY,a:{t:{y:s(a),q:a?.id&&`#${a.id}`||q&&`[name="${q}"]`},m:{y:s(o(y)),q:y}}},localStorage._mpa=JSON.stringify(t)});function b(){if(o("[autofocus]"))return;let t=g(f());if(!t)return;let{y:e,a:{t:n,m:r}}=t,a=n.q&&o(n.q)||r.q&&o(r.q);c(a,"mpa-skip-focus")||(p("focus",a),p("select",a)),!c(l.body,"mpa-skip-scroll")&&e&&(a?i.scrollTo({top:i.scrollY+s(a)-(n.q&&n.y||r.q&&r.y||0)}):i.scrollTo({top:e}))}function p(t,e){e&&e[t]&&e[t]()}function g(t){let e=localStorage._mpa;return e=e&&JSON.parse(e),t==null?e:e&&e[t]}b()})();
