(()=>{let l=document,r=window,o=l.querySelector.bind(l);function s(t,e){return t?.hasAttribute(e)}function u(t,e){return t?.getAttribute(e)}function p(){let t=u(l.body,"mpa-page-name");return t||new URL(l.location.href).pathname.replace(/\/$/,"")}let d=null;r.addEventListener("click",t=>{d=t.target});function m(t){return t?.getBoundingClientRect().top}r.addEventListener("unload",()=>{let t=y()||{},e=new Set(t.__||[]),n=p();s(l.body,"mpa-persist")&&(e.add(n),t.__=Array.from(e));for(let f in Object.keys(t))e.has(f)||f==="__"||delete t[f];let i=l.activeElement,a=i===l.body?d:i,c=u(a,"mpa-target");c&&(a=o(c));let b=u(a?.closest("[mpa-miss]"),"mpa-miss"),q=a?.getAttribute("name");t[n]={y:r.scrollY,a:{t:{y:m(a),q:a?.id&&`#${a.id}`||q&&`[name="${q}"]`},m:{y:m(o(b)),q:b}}},localStorage._mpa=JSON.stringify(t)});function _(){if(o("[autofocus]"))return;let t=y(p());if(!t)return;let{y:e,a:{t:n,m:i}}=t,a,c=n.q&&(a=o(n.q))?n.y:i.q&&(a=o(i.q))?i.y:0;s(a,"mpa-skip-focus")||(g("focus",a),g("select",a)),!s(l.body,"mpa-skip-scroll")&&e&&(a?r.scrollTo({top:r.scrollY+m(a)-c}):r.scrollTo({top:e}))}function g(t,e){e&&e[t]&&e[t]()}function y(t){let e=localStorage._mpa;return e=e&&JSON.parse(e),t==null?e:e&&e[t]}_()})();
